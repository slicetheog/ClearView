<Window x:Class="ClearView.UI.SettingsWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="ClearView Settings" Height="650" Width="450"
        WindowStyle="None" AllowsTransparency="True" Background="Transparent"
        WindowStartupLocation="CenterScreen" ShowInTaskbar="False">

    <Border CornerRadius="12" Background="#CC2D2D2D" BorderBrush="#555" BorderThickness="1">
        <Grid Margin="15">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <TextBlock Text="Settings" FontSize="20" FontWeight="Bold" Foreground="White" Margin="0,0,0,15"/>

            <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
                <StackPanel>
                    <TextBlock Text="General" Style="{StaticResource HeaderStyle}"/>
                    <CheckBox x:Name="RunOnStartupCheckBox" Content="Run on Windows startup" Foreground="White" Margin="0,5,0,0"/>

                    <!-- NEW: Mode row (single row insertion). Keep styling/layout consistent with surrounding controls. -->
                    <StackPanel Orientation="Horizontal" Margin="0,8,0,0" VerticalAlignment="Center">
                        <TextBlock Text="Mode" Foreground="White" VerticalAlignment="Center" Width="90"/>
                        <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                            <RadioButton x:Name="ModeCleanRadio" Content="Clean" GroupName="ModeGroup" Foreground="White" Margin="0,0,12,0"/>
                            <RadioButton x:Name="ModePowerRadio" Content="Power Hungry" GroupName="ModeGroup" Foreground="White"/>
                        </StackPanel>
                    </StackPanel>
                    <!-- END NEW -->

                    <TextBlock Text="Hotkey" Style="{StaticResource HeaderStyle}" Margin="0,15,0,0"/>
                    <StackPanel Orientation="Horizontal" Margin="0,5,0,0">
                        <TextBox x:Name="HotkeyTextBox" IsReadOnly="True" Width="200" Text="Ctrl + Space"/>
                        <Button x:Name="SetHotkeyButton" Content="Set" Click="SetHotkey_Click" Margin="5,0,0,0" Width="50"/>
                    </StackPanel>

                    <TextBlock Text="Search Scope" Style="{StaticResource HeaderStyle}" Margin="0,20,0,0"/>
                    <TextBlock Text="Select drives to include in the search." Style="{StaticResource SubHeaderStyle}"/>
                    <ItemsControl x:Name="DrivesItemsControl">
                        <ItemsControl.ItemTemplate>
                            <DataTemplate>
                                <CheckBox IsChecked="{Binding IsSelected, Mode=TwoWay}"
                                          Content="{Binding Name}"
                                          Foreground="White"/>
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>

                    <TextBlock Text="Indexing Schedule" Style="{StaticResource HeaderStyle}" Margin="0,20,0,0"/>
                    <TextBlock Text="Choose how often the file index should be rebuilt." Style="{StaticResource SubHeaderStyle}"/>
                    <RadioButton x:Name="ManualRadio" Content="Manual (via 'Rebuild Index' button)" GroupName="Schedule" Foreground="White" IsChecked="True" Checked="RadioButton_Checked"/>
                    <RadioButton x:Name="StartupRadio" Content="Every time the application starts" GroupName="Schedule" Foreground="White" Checked="RadioButton_Checked"/>
                    <RadioButton x:Name="IntervalRadio" Content="Run on an interval" GroupName="Schedule" Foreground="White" Checked="RadioButton_Checked"/>
                    <StackPanel Orientation="Horizontal" Margin="20,5,0,0">
                        <TextBox x:Name="IntervalValueTextBox" Width="50" Text="24"/>
                        <ComboBox x:Name="IntervalUnitComboBox" Margin="5,0,0,0" Width="100">
                            <ComboBoxItem Content="Hours"/>
                            <ComboBoxItem Content="Days"/>
                            <ComboBoxItem Content="Weeks"/>
                        </ComboBox>
                    </StackPanel>

                    <TextBlock Text="Excluded Folders" Style="{StaticResource HeaderStyle}" Margin="0,20,0,0"/>
                    <TextBlock Text="The indexer will skip these folders and their subfolders." Style="{StaticResource SubHeaderStyle}"/>
                    <ListBox x:Name="ExcludedFoldersListBox" Height="100" Background="#333" Foreground="White" BorderThickness="1" BorderBrush="#555"/>
                    <StackPanel Orientation="Horizontal" Margin="0,5,0,0">
                        <Button Content="Add Folder" Click="AddFolder_Click" Width="80"/>
                        <Button Content="Remove Folder" Click="RemoveFolder_Click" Width="100" Margin="5,0,0,0"/>
                    </StackPanel>

                    <TextBlock Text="Excluded File Types" Style="{StaticResource HeaderStyle}" Margin="0,20,0,0"/>
                    <TextBlock Text="The indexer will skip files with these extensions." Style="{StaticResource SubHeaderStyle}"/>
                    <ItemsControl x:Name="ExcludedFileTypesItemsControl">
                        <ItemsControl.ItemTemplate>
                            <DataTemplate>
                                <CheckBox IsChecked="{Binding IsSelected, Mode=TwoWay}"
                                          Content="{Binding Name}"
                                          Foreground="White"/>
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                        <ItemsControl.ItemsPanel>
                            <ItemsPanelTemplate>
                                <WrapPanel Orientation="Horizontal"/>
                            </ItemsPanelTemplate>
                        </ItemsControl.ItemsPanel>
                    </ItemsControl>

                </StackPanel>
            </ScrollViewer>

            <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Right" VerticalAlignment="Bottom" Margin="0,15,0,0">
                <Button Content="Rebuild Index Now" Click="RebuildIndex_Click" HorizontalAlignment="Left" Margin="0,0,20,0"/>
                <Button Content="Save" Click="Save_Click" Width="80"/>
                <Button Content="Cancel" Click="Cancel_Click" Width="80" Margin="10,0,0,0"/>
            </StackPanel>
        </Grid>
    </Border>
</Window>